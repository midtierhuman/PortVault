<h2 mat-dialog-title>Add Transaction</h2>

<mat-dialog-content>
  <form [formGroup]="transactionForm" class="transaction-form">
    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Symbol</mat-label>
        <input matInput formControlName="symbol" placeholder="TATASTEEL" required />
        @if (transactionForm.controls.symbol.hasError('required')) {
        <mat-error>Symbol is required</mat-error>
        } @if (transactionForm.controls.symbol.hasError('maxlength')) {
        <mat-error>Symbol cannot exceed 100 characters</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>ISIN</mat-label>
        <input matInput formControlName="isin" placeholder="INE081A01020" required />
        @if (transactionForm.controls.isin.hasError('required')) {
        <mat-error>ISIN is required</mat-error>
        } @if (transactionForm.controls.isin.hasError('maxlength')) {
        <mat-error>ISIN cannot exceed 50 characters</mat-error>
        }
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Trade Date</mat-label>
        <input matInput [matDatepicker]="tradeDatePicker" formControlName="tradeDate" required />
        <mat-datepicker-toggle matSuffix [for]="tradeDatePicker"></mat-datepicker-toggle>
        <mat-datepicker #tradeDatePicker></mat-datepicker>
        @if (transactionForm.controls.tradeDate.hasError('required')) {
        <mat-error>Trade date is required</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Order Execution Time</mat-label>
        <input
          matInput
          [matDatepicker]="executionTimePicker"
          formControlName="orderExecutionTime"
        />
        <mat-datepicker-toggle matSuffix [for]="executionTimePicker"></mat-datepicker-toggle>
        <mat-datepicker #executionTimePicker></mat-datepicker>
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Segment</mat-label>
        <mat-select formControlName="segment" required>
          @for (segment of segments; track segment) {
          <mat-option [value]="segment">{{ segment }}</mat-option>
          }
        </mat-select>
        @if (transactionForm.controls.segment.hasError('required')) {
        <mat-error>Segment is required</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Series</mat-label>
        <input matInput formControlName="series" placeholder="EQ" />
        @if (transactionForm.controls.series.hasError('maxlength')) {
        <mat-error>Series cannot exceed 50 characters</mat-error>
        }
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Trade Type</mat-label>
        <mat-select formControlName="tradeType" required>
          @for (type of tradeTypes; track type) {
          <mat-option [value]="type">{{ type }}</mat-option>
          }
        </mat-select>
        @if (transactionForm.controls.tradeType.hasError('required')) {
        <mat-error>Trade type is required</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Quantity</mat-label>
        <input matInput type="number" formControlName="quantity" min="0.000001" required />
        @if (transactionForm.controls.quantity.hasError('required')) {
        <mat-error>Quantity is required</mat-error>
        } @if (transactionForm.controls.quantity.hasError('min')) {
        <mat-error>Quantity must be greater than 0</mat-error>
        }
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Price</mat-label>
        <input matInput type="number" formControlName="price" min="0.000001" required />
        @if (transactionForm.controls.price.hasError('required')) {
        <mat-error>Price is required</mat-error>
        } @if (transactionForm.controls.price.hasError('min')) {
        <mat-error>Price must be greater than 0</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Trade ID</mat-label>
        <input matInput formControlName="tradeID" placeholder="Optional" />
        @if (transactionForm.controls.tradeID.hasError('maxlength')) {
        <mat-error>Trade ID cannot exceed 100 characters</mat-error>
        }
      </mat-form-field>
    </div>

    <div class="form-row">
      <mat-form-field appearance="outline">
        <mat-label>Order ID</mat-label>
        <input matInput formControlName="orderID" placeholder="Optional" />
        @if (transactionForm.controls.orderID.hasError('maxlength')) {
        <mat-error>Order ID cannot exceed 100 characters</mat-error>
        }
      </mat-form-field>
    </div>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button mat-raised-button color="primary" (click)="onSave()" [disabled]="transactionForm.invalid">
    Add Transaction
  </button>
</mat-dialog-actions>
